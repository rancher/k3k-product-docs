<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VirtualClusterPolicy :: SUSE® Virtual Clusters</title>
    <link rel="prev" href="advanced-usage.html">
    <link rel="next" href="howtos/airgap.html">
    <meta name="generator" content="Antora 3.1.9">
    <link rel="stylesheet" href="../../../_/css/site.css">
<meta http-equiv="last-modified" content="2025-09-16"/>
<link rel="stylesheet" href="../../../_/css/search.css">
<link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="../../../_/css/font-styles.css">
<link rel="stylesheet" href="../../../_/fonts/css/all.css">
<link rel="stylesheet" href="../../../_/css/site-extra.css">
<link rel="stylesheet" href="../../../_/css/vendor/tabs.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=SUSE:wght@100..800&display=swap&family=SUSE+Mono:ital,wght@0,100..800;1,100..800" rel="stylesheet">
<link href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css" rel="stylesheet">
<!-- <link href="https://fonts.googleapis.com/css?family=Montserrat|Roboto&display=swap" rel="stylesheet"> -->
<link rel="stylesheet" href="../../../_/css/vendor/light.css">
<script src="/docserv/res/lightheaded/analytics.js" type="text/javascript"></script>

<script type="module">
  import { defineCustomElements, setAssetPath } from 'https://d12w0ryu9hjsx8.cloudfront.net/shared-header/1.5/shared-header.esm.js';
  defineCustomElements();
  setAssetPath("https://d12w0ryu9hjsx8.cloudfront.net/shared-header/1.5/assets");
</script>    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs'; mermaid.initialize({"startOnLoad":true});</script>
<!-- Canonical link -->
<link href="" rel="canonical"/>

<!-- Default English link -->
<link href="https://documentation.suse.com/cloudnative/virtual-clusters/latest/en/virtualclusterpolicy.html" hreflang="x-default" rel="alternate"/>

<!-- Link for the currently processed page -->
<link href="https://documentation.suse.com/cloudnative/virtual-clusters/latest/en/virtualclusterpolicy.html" hrefLang="en-US" rel="alternate" />











<shared-header language="en" languages='{
"en": { "label": "English", "url": "https://documentation.suse.com/en-us/" },
"de": { "label": "Deutsch", "url": "https://documentation.suse.com/de-de/" },
"fr": { "label": "Français", "url": "https://documentation.suse.com/fr-fr/" },
"es": { "label": "Español", "url": "https://documentation.suse.com/es-es/" },
"zh_CN": { "label": "中文", "url": "https://documentation.suse.com/zh-cn/" },
"pt_BR": { "label": "Português Brasileiro", "url": "https://documentation.suse.com/pt-br/" }
}'>
</shared-header>
<a target=_blank"" class="survey-link" href="https://suselinux.fra1.qualtrics.com/jfe/form/SV_bEiGZbUNzLD8Tcy"> Documentation survey </a><div class="body">
<div class="nav-container" data-component="virtual-clusters" data-version="latest">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title">SUSE® Virtual Clusters</h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="introduction.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="k3k.html">K3k: Kubernetes in Kubernetes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="architecture.html">Architecture</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="development.html">Development</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="advanced-usage.html">Advanced Usage</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="virtualclusterpolicy.html">VirtualClusterPolicy</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">How-to guides</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="howtos/airgap.html">Installing Virtual Clusters in an air-gapped environment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="howtos/choose-mode.html">Choosing between Shared and Virtual Mode</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="howtos/create-virtual-clusters.html">Creating a Virtual Cluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="howtos/expose-workloads.html">Exposing workloads outside a Virtual Cluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="howtos/adding-custom-cert.html">Adding custom certificates for k3s from k3k cluster</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">References</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="references/crds.html">Customer Resource Definitions (CRDs)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="references/k3kcli.html">k3kcli</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="howtos/troubleshooting.html">Troubleshooting</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">SUSE® Virtual Clusters</span>
    <span class="version">Latest</span>
  </div>
  <ul class="components">
        <li class="component is-current">
          <div class="title"><a href="introduction.html">SUSE® Virtual Clusters</a></div>
          <ul class="versions">
            <li class="version is-current is-latest">
              <a href="introduction.html">Latest</a>
            </li>
          </ul>
        </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
<ul>
    <li>
      <a href="https://documentation.suse.com/" title="documentation.suse.com" aria-label="SUSE Documentation Home">Documentation Home</a>
    </li>
    <li>
      <a href="" title="" aria-label="SUSE Documentation - ">
        
      </a>
    </li>
      <li>
          <a href="virtualclusterpolicy.html" title="VirtualClusterPolicy" aria-label="VirtualClusterPolicy">VirtualClusterPolicy</a>
      </li>
  </ul>
</nav>  <div class="edit-this-page"><a href="https://github.com/rancher/k3k-product-docs/edit/main/versions/latest/modules/en/pages/virtualclusterpolicy.adoc"><strong>Edit</strong></a></div>
        <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <label class="visual-search-label-bc" for="search-input">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
          <input label="Search" aria-label="Search" id="search-input" type="text" placeholder="Search the docs" >
          <label class="filter checkbox" style="display: none">
            <input type="checkbox" data-facet-filter="component:virtual-clusters" checked> Only this project
          </label>
        </div>
      </div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="On this page" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">VirtualClusterPolicy</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The <code>VirtualClusterPolicy</code> Custom Resource in K3k provides a way to define and enforce consistent configurations, security settings, and resource management rules for your virtual clusters and the Namespaces they operate within.</p>
</div>
<div class="paragraph">
<p>By using VCPs, administrators can centrally manage these aspects, reducing manual configuration, ensuring alignment with organizational standards, and enhancing the overall security and operational consistency of the K3k environment.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_core_concepts"><a class="anchor" href="#_core_concepts"></a>Core Concepts</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_what_is_a_virtualclusterpolicy"><a class="anchor" href="#_what_is_a_virtualclusterpolicy"></a>What is a VirtualClusterPolicy?</h3>
<div class="paragraph">
<p>A <code>VirtualClusterPolicy</code> is a cluster-scoped Kubernetes Custom Resource that specifies a set of rules and configurations. These policies are then applied to K3k virtual clusters (<code>Cluster</code> resources) operating within Kubernetes Namespaces that are explicitly bound to a VCP.</p>
</div>
</div>
<div class="sect2">
<h3 id="_binding_a_policy_to_a_namespace"><a class="anchor" href="#_binding_a_policy_to_a_namespace"></a>Binding a Policy to a Namespace</h3>
<div class="paragraph">
<p>To apply a <code>VirtualClusterPolicy</code> to one or more Namespaces (and thus to all K3k <code>Cluster</code> resources within those Namespaces), you need to label the desired Namespace(s).</p>
</div>
<div class="paragraph">
<p>Add the following label to your Namespace metadata:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>`policy.k3k.io/policy-name: &lt;YOUR_POLICY_NAME&gt;`</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example: Labeling a Namespace</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: v1
kind: Namespace
metadata:
  name: my-app-namespace
  labels:
    policy.k3k.io/policy-name: "standard-dev-policy"</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, <code>my-app-namespace</code> will adhere to the rules defined in the <code>VirtualClusterPolicy</code> named <code>standard-dev-policy</code>. Multiple Namespaces can be bound to the same policy for uniform configuration, or different Namespaces can be bound to distinct policies.</p>
</div>
<div class="paragraph">
<p>It&#8217;s also important to note what happens when a Namespace&#8217;s policy binding changes. If a Namespace is unbound from a VirtualClusterPolicy (by removing the policy.k3k.io/policy-name label), K3k will clean up and remove the resources (such as ResourceQuotas, LimitRanges, and managed Namespace labels) that were originally applied by that policy. Similarly, if the label is changed to bind the Namespace to a new VirtualClusterPolicy, K3k will first remove the resources associated with the old policy before applying the configurations from the new one, ensuring a clean transition.</p>
</div>
</div>
<div class="sect2">
<h3 id="_default_policy_values"><a class="anchor" href="#_default_policy_values"></a>Default Policy Values</h3>
<div class="paragraph">
<p>If you create a <code>VirtualClusterPolicy</code> without specifying any <code>spec</code> fields (for example, using <code>k3kcli policy create my-default-policy</code>), it will be created with default settings. Currently, this includes <code>spec.allowedMode</code> being set to <code>shared</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml"># Example of a minimal VCP (after creation with defaults)
apiVersion: k3k.io/v1alpha1
kind: VirtualClusterPolicy
metadata:
  name: my-default-policy
spec:
  allowedMode: shared</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_key_capabilities_examples"><a class="anchor" href="#_key_capabilities_examples"></a>Key Capabilities &amp; Examples</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A <code>VirtualClusterPolicy</code> can configure several aspects of the Namespaces it&#8217;s bound to and the virtual clusters operating within them.</p>
</div>
<div class="sect2">
<h3 id="_restricting_allowed_virtual_cluster_modes_allowedmode"><a class="anchor" href="#_restricting_allowed_virtual_cluster_modes_allowedmode"></a>Restricting Allowed Virtual Cluster Modes (<code>AllowedMode</code>)</h3>
<div class="paragraph">
<p>You can restrict the <code>mode</code> (e.g., "shared" or "virtual") in which K3k <code>Cluster</code> resources can be provisioned within bound Namespaces. If a <code>Cluster</code> is created in a bound Namespace with a mode not allowed in <code>allowedMode</code>, its creation might proceed but an error should be reported in the <code>Cluster</code> resource&#8217;s status.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong> Allow only "shared" mode clusters.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: k3k.io/v1alpha1
kind: VirtualClusterPolicy
metadata:
  name: shared-only-policy
spec:
  allowedModeTypes:
  - shared</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also specify this using the CLI: <code>k3kcli policy create --mode shared shared-only-policy</code> (or <code>--mode virtual</code>).</p>
</div>
</div>
<div class="sect2">
<h3 id="_defining_resource_quotas_quota"><a class="anchor" href="#_defining_resource_quotas_quota"></a>Defining Resource Quotas (<code>quota</code>)</h3>
<div class="paragraph">
<p>You can define resource consumption limits for bound Namespaces by specifying a <code>ResourceQuota</code>. K3k will create a <code>ResourceQuota</code> object in each bound Namespace with the provided specifications.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong> Set CPU, memory, and pod limits.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: k3k.io/v1alpha1
kind: VirtualClusterPolicy
metadata:
  name: quota-policy
spec:
  quota:
    hard:
      cpu: "10"
      memory: "20Gi"
      pods: "10"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_setting_limit_ranges_limit"><a class="anchor" href="#_setting_limit_ranges_limit"></a>Setting Limit Ranges (<code>limit</code>)</h3>
<div class="paragraph">
<p>You can define default resource requests/limits and min/max constraints for containers running in bound Namespaces by specifying a <code>LimitRange</code>. K3k will create a <code>LimitRange</code> object in each bound Namespace.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong> Define default CPU requests/limits and min/max CPU.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: k3k.io/v1alpha1
kind: VirtualClusterPolicy
metadata:
  name: limit-policy
spec:
  limit:
    limits:
    - default:
        cpu: "500m"
      defaultRequest:
        cpu: "500m"
      max:
        cpu: "1"
      min:
        cpu: "100m"
      type: Container</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_managing_network_isolation_disablenetworkpolicy"><a class="anchor" href="#_managing_network_isolation_disablenetworkpolicy"></a>Managing Network Isolation (<code>disableNetworkPolicy</code>)</h3>
<div class="paragraph">
<p>By default, K3k creates a <code>NetworkPolicy</code> in bound Namespaces to provide network isolation for virtual clusters (especially in shared mode). You can disable the creation of this default policy.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong> Disable the default NetworkPolicy.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: k3k.io/v1alpha1
kind: VirtualClusterPolicy
metadata:
  name: no-default-netpol-policy
spec:
  disableNetworkPolicy: true</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_enforcing_pod_security_admission_podsecurityadmissionlevel"><a class="anchor" href="#_enforcing_pod_security_admission_podsecurityadmissionlevel"></a>Enforcing Pod Security Admission (<code>podSecurityAdmissionLevel</code>)</h3>
<div class="paragraph">
<p>You can enforce Pod Security Standards (PSS) by specifying a Pod Security Admission (PSA) level. K3k will apply the corresponding PSA labels to each bound Namespace. The allowed values are <code>privileged</code>, <code>baseline</code>, <code>restricted</code>, and this will add labels like <code>pod-security.kubernetes.io/enforce: &lt;level&gt;</code> to the bound Namespace.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong> Enforce the "baseline" PSS level.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: k3k.io/v1alpha1
kind: VirtualClusterPolicy
metadata:
  name: baseline-psa-policy
spec:
  podSecurityAdmissionLevel: baseline</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_additional_information"><a class="anchor" href="#_additional_information"></a>Additional information</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>For a complete reference of all <code>VirtualClusterPolicy</code> spec fields, see <a href="/references/crds.adoc#virtualclusterpolicy">API Reference for VirtualClusterPolicy</a>.</p>
</li>
<li>
<p>To understand how VCPs fit into the overall K3k system, see <a href="architecture.html" class="xref page">Architecture</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="advanced-usage.html">Advanced Usage</a></span>
  <span class="next"><a href="howtos/airgap.html">Installing Virtual Clusters in an air-gapped environment</a></span>
</nav>
</article>
  </div>
</main>
</div>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
<script src="../../../_/js/vendor/langSelection.js"></script>
<script async src="../../../_/js/vendor/tabs.js"></script>


<script src="../../../_/js/CNLanguageSwitcher.js"></script>
  </body>
</html>
